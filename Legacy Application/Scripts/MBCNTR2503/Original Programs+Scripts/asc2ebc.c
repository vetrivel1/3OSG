/* ******************************************

    asc2ebc.c

****************************************** */

#include <stdio.h>
#include <unistd.h>
#include <fcntl.h>
#include <string.h>
#include <errno.h>
#include <stdlib.h>
#include <sys/mtio.h>

int a2e[] = {
	0,1,2,3,55,45,46,47,22,5,37,11,12,13,14,159,16,17,18,19,182,181,50,
	38,24,25,63,39,28,29,30,31,64,90,127,123,91,108,80,125,77,93,92,78,107,
	96,75,97,240,241,242,243,244,245,246,247,248,249,122,94,76,126,110,
	111,124,193,194,195,196,197,198,199,200,201,209,210,211,212,213,214,
	215,216,217,226,227,228,229,230,231,232,233,173,224,189,95,109,121,129,
	130,131,132,133,134,135,136,137,145,146,147,148,149,150,151,152,153,
	162,163,164,165,166,167,168,169,192,106,208,161,7,104,220,81,66,67,68,
	71,72,82,83,84,87,86,88,99,103,113,156,158,203,204,205,219,221,223,
	236,252,176,177,178,62,180,69,85,206,222,73,105,154,155,171,15,186,
	184,183,170,138,139,60,61,98,79,100,101,102,32,33,34,112,35,114,115,
	116,190,118,119,120,128,36,21,140,141,142,65,6,23,40,41,157,42,43,
	44,9,10,172,74,174,175,27,48,49,250,26,51,52,53,54,89,8,56,188,57,
	160,191,202,58,254,59,4,207,218,20,225,143,70,117,253,235,238,237,
	144,239,179,251,185,234,187,255};

void asc2ebc(char *to, char *from, int copylen, int ispacked)

{  char *b1, *c1;
	int i;

	if (ispacked==1)
		memcpy(to, from, copylen);
	else
	if (ispacked==2)
	{  for(b1=from, c1=to; b1-from<copylen-1; b1++, c1++)
			*c1 = a2e[*b1 & 255];
		i = *b1 & 255;
		if (i==32)
			*c1 = ' ';
		else
      if(i<'p')
      {	i -= '0';
      	i += 192;
      }
      else
      {	i -= 'p';
      	i += 208;
      }
	}
	else
		for(b1=from, c1=to; b1-from<copylen; b1++, c1++)
			*c1 = a2e[*b1 & 255];
	return;
}

