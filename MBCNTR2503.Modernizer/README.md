MBCNTR2503.Modernizer

## Overview
This project modernizes the legacy MBCNTR2503 COBOL system to .NET, converting EBCDIC packed decimal mortgage billing records to ASCII format while maintaining exact parity with legacy outputs.

## Current Status
- **Parity Achievement**: 11.2% improvement (145 errors eliminated from ~1295 total)
- **Major Fixes Completed**:
  - ‚úÖ LENGTH_MISMATCH pattern (120 errors fixed) - ASCII detection in text fields
  - ‚úÖ ZERO_VARIATIONS pattern (5 errors fixed) - MB-PAYMENT-AMOUNT field mapping corrected
  - ‚úÖ Field metadata loading path resolved
- **Remaining**: ~1150 field differences across all records

## üìä Latest Parity Report

*This report was generated by running `generate_report.py` on 2025-09-29 17:15:18*

### Overall Summary
- **Total Jobs Processed**: 4
- **Total Files Compared**: 56
- **Overall Size Match**: 100.00%
- **Overall Content Match**: 97.96%

### Job Status Details

| Job ID | Files | Size Match % | Content Match % | Status |
|--------|-------|--------------|-----------------|--------|
| 69172 | 14 | 100.00% | 98.04% | üü¢ GOOD |
| 80147 | 14 | 100.00% | 97.92% | üü¢ GOOD |
| 80299 | 14 | 100.00% | 97.94% | üü¢ GOOD |
| 80362 | 14 | 100.00% | 97.92% | üü¢ GOOD |

### File-by-File Details

#### Job 69172
- **Files Compared**: 14/14
- **Size Match**: 100.00%
- **Content Match**: 98.04%
- **Status**: üü¢ GOOD

**File Details:**
- ‚úÖ `69172.4300` - [OK] Perfect Match
- ‚úÖ `69172.4300.txt` - [OK] Perfect Match
- ‚úÖ `69172.4300.txt.length` - [OK] Perfect Match
- ‚úÖ `69172.4300.txt.new` - [OK] Perfect Match
- ‚úÖ `69172.4300.txt.suspect` - [OK] Perfect Match
- ‚ùå `69172.dat.asc` - [NOT OK] Content (99.91%)
- ‚úÖ `69172.dat.asc.11.1.d` - [OK] Perfect Match
- ‚ùå `69172.dat.asc.11.1.p` - [NOT OK] Content (99.91%)
- ‚ùå `69172.dat.asc.11.1.p.keyed` - [NOT OK] Content (99.88%)
- ‚ùå `69172.dat.asc.11.1.s` - [NOT OK] Content (99.91%)
- ‚úÖ `69172.dat.rectype` - [OK] Perfect Match
- ‚úÖ `69172.dat.total` - [OK] Perfect Match
- ‚úÖ `69172.ncpjax` - [OK] Perfect Match
- ‚ùå `69172p.set` - [NOT OK] Content (72.92%)

#### Job 80147
- **Files Compared**: 14/14
- **Size Match**: 100.00%
- **Content Match**: 97.92%
- **Status**: üü¢ GOOD

**File Details:**
- ‚úÖ `80147.4300` - [OK] Perfect Match
- ‚úÖ `80147.4300.txt` - [OK] Perfect Match
- ‚úÖ `80147.4300.txt.length` - [OK] Perfect Match
- ‚úÖ `80147.4300.txt.new` - [OK] Perfect Match
- ‚úÖ `80147.4300.txt.suspect` - [OK] Perfect Match
- ‚ùå `80147.dat.asc` - [NOT OK] Content (99.72%)
- ‚ùå `80147.dat.asc.11.1.d` - [NOT OK] Content (99.93%)
- ‚ùå `80147.dat.asc.11.1.p` - [NOT OK] Content (99.81%)
- ‚ùå `80147.dat.asc.11.1.p.keyed` - [NOT OK] Content (99.69%)
- ‚ùå `80147.dat.asc.11.1.s` - [NOT OK] Content (99.69%)
- ‚úÖ `80147.dat.rectype` - [OK] Perfect Match
- ‚úÖ `80147.dat.total` - [OK] Perfect Match
- ‚úÖ `80147.ncpjax` - [OK] Perfect Match
- ‚ùå `80147p.set` - [NOT OK] Content (72.05%)

#### Job 80299
- **Files Compared**: 14/14
- **Size Match**: 100.00%
- **Content Match**: 97.94%
- **Status**: üü¢ GOOD

**File Details:**
- ‚úÖ `80299.4300` - [OK] Perfect Match
- ‚úÖ `80299.4300.txt` - [OK] Perfect Match
- ‚úÖ `80299.4300.txt.length` - [OK] Perfect Match
- ‚úÖ `80299.4300.txt.new` - [OK] Perfect Match
- ‚úÖ `80299.4300.txt.suspect` - [OK] Perfect Match
- ‚ùå `80299.dat.asc` - [NOT OK] Content (99.86%)
- ‚ùå `80299.dat.asc.11.1.d` - [NOT OK] Content (99.93%)
- ‚ùå `80299.dat.asc.11.1.p` - [NOT OK] Content (99.79%)
- ‚ùå `80299.dat.asc.11.1.p.keyed` - [NOT OK] Content (99.62%)
- ‚ùå `80299.dat.asc.11.1.s` - [NOT OK] Content (99.89%)
- ‚úÖ `80299.dat.rectype` - [OK] Perfect Match
- ‚úÖ `80299.dat.total` - [OK] Perfect Match
- ‚úÖ `80299.ncpjax` - [OK] Perfect Match
- ‚ùå `80299p.set` - [NOT OK] Content (72.07%)

#### Job 80362
- **Files Compared**: 14/14
- **Size Match**: 100.00%
- **Content Match**: 97.92%
- **Status**: üü¢ GOOD

**File Details:**
- ‚úÖ `80362.4300` - [OK] Perfect Match
- ‚úÖ `80362.4300.txt` - [OK] Perfect Match
- ‚úÖ `80362.4300.txt.length` - [OK] Perfect Match
- ‚úÖ `80362.4300.txt.new` - [OK] Perfect Match
- ‚úÖ `80362.4300.txt.suspect` - [OK] Perfect Match
- ‚ùå `80362.dat.asc` - [NOT OK] Content (99.75%)
- ‚ùå `80362.dat.asc.11.1.d` - [NOT OK] Content (99.93%)
- ‚ùå `80362.dat.asc.11.1.p` - [NOT OK] Content (99.81%)
- ‚ùå `80362.dat.asc.11.1.p.keyed` - [NOT OK] Content (99.67%)
- ‚ùå `80362.dat.asc.11.1.s` - [NOT OK] Content (99.73%)
- ‚úÖ `80362.dat.rectype` - [OK] Perfect Match
- ‚úÖ `80362.dat.total` - [OK] Perfect Match
- ‚úÖ `80362.ncpjax` - [OK] Perfect Match
- ‚ùå `80362p.set` - [NOT OK] Content (72.02%)


---
*To regenerate this report, run: `python generate_report.py`*



















## Prerequisites
- .NET 8 SDK (Windows/macOS/Linux)
- Python 3.x for parity checking scripts
- Config files at `config/base/mblps` (mirrors legacy mblps structure)

## Quick Start

### 1. Build the Schema
```bash
dotnet run --project src/Cnp.Cli -- build-schema --schema "config/base/mblps" --out "schemas/compiled"
```
**Output:** `schemas/compiled/<sha>.schema.json` - Compiled schema for pipeline consumption

### 2. Run the Pipeline
```bash
dotnet "/Users/vshanmu/3OSG/MBCNTR2503.Modernizer/src/Cnp.Cli/bin/Debug/net8.0/Cnp.Cli.dll" run-pipeline --job 69172 --schema "/Users/vshanmu/3OSG/MBCNTR2503.Modernizer/config/base/mblps" --verbose
```

### 3. Check Parity
```bash
python3 debug-parity.py 69172
```

## Pipeline Architecture

### Core Components
- **src/Cnp.Schema**: Schema compiler and models for DD file processing
- **src/Cnp.Decoders**: Packed/zoned/binary/EBCDIC decoding utilities
- **src/Cnp.Pipeline**: Pipeline orchestrator and processing stages
  - `EbcdicProcessor.cs`: EBCDIC to ASCII conversion, record type processing
  - `MB2000FieldMapper.cs`: Field mapping with override support
- **src/Cnp.Cli**: CLI entrypoint and command handlers

### Data Flow
1. **Input**: Legacy EBCDIC files (`.dat.asc.11.1.p.keyed`)
2. **Processing**: EBCDIC‚ÜíASCII conversion, field mapping, packed decimal handling
3. **Output**: MB2000 format files (`.set`) with 2000-byte records
4. **Validation**: Parity checking against expected legacy outputs

## Configuration Files

### Schema Definition (`mblps.dd`)
```
Field-Name, Offset, Length, Type, DecimalPlaces
MB-PAYMENT-AMOUNT, 749, 6, Packed Number, 2
MB-FIRST-P-I, 755, 6, Packed Number, 2
```

### Field Overrides (`mb2000.overrides.json`)
```json
{
  "source": "MB-PAYMENT-AMOUNT",
  "target": "MB-PAYMENT-AMOUNT", 
  "sourceOffset": 323,
  "sourceLength": 6,
  "mode": "packed",
  "trimOutput": false
}
```

### Field Metadata (`FieldDefinitions_Generated.json`)
```json
{
  "recordLayouts": {
    "MB_PAYMENT_AMOUNT": {
      "startPosition": 749,
      "length": 6,
      "type": 1,
      "decimalPlaces": 2,
      "description": "Packed Number field"
    }
  }
}
```

## Detailed Usage Guide

### Running the Pipeline

#### Step 1: Build Schema
```bash
# Compile DD files into JSON schema
dotnet run --project src/Cnp.Cli -- build-schema --schema "config/base/mblps" --out "schemas/compiled"
```

#### Step 2: Execute Pipeline
```bash
# Run modernization pipeline for a specific job
dotnet "/Users/vshanmu/3OSG/MBCNTR2503.Modernizer/src/Cnp.Cli/bin/Debug/net8.0/Cnp.Cli.dll" run-pipeline \
  --job 69172 \
  --schema "/Users/vshanmu/3OSG/MBCNTR2503.Modernizer/config/base/mblps" \
  --verbose
```

**Input Files Expected:**
- `Legacy Application/Expected_Outputs/69172/69172.dat.asc.11.1.p.keyed`

**Output Files Generated:**
- `out/69172/69172p.set` (2000-byte MB2000 records)
- `out/69172/mb2000_69172.log` (processing log)

### Parity Checking

#### Basic Parity Check
```bash
python3 debug-parity.py 69172
```

#### Understanding Parity Output
```
--- Summary ---
Found 1150 total field differences across all records.

Common Error Patterns:
- LENGTH_MISMATCH: Field length discrepancies
- ZERO_VARIATIONS: Zero value encoding issues  
- QUESTION_MARKS: Character encoding problems
- PACKED_DECIMAL_CONVERSION: Packed decimal format issues
```

#### Advanced Parity Analysis
```bash
# Generate detailed field-by-field comparison
python3 debug-parity.py 69172 > parity_detailed.log

# Analyze specific error patterns
python3 advanced_pattern_analyzer.py
```

### JSON Schema Parsing

#### Schema Structure
The compiled schema (`schemas/compiled/<sha>.schema.json`) contains:

```json
{
  "title": "MB2000 Output Record",
  "type": "object", 
  "properties": {
    "MB-PAYMENT-AMOUNT": {
      "type": "string",
      "maxLength": 11,
      "description": "Payment amount field",
      "x-offset": 749,
      "x-length": 6,
      "x-scale": 2,
      "x-type": "PackedDecimal"
    }
  }
}
```

#### Field Metadata Loading
The `MB2000FieldMapper.cs` loads field definitions from `FieldDefinitions_Generated.json`:

```csharp
private static Dictionary<string, FieldMetadata> LoadFieldMetadata()
{
    // Tries multiple paths to find FieldDefinitions_Generated.json
    var possiblePaths = new[]
    {
        "/Users/vshanmu/3OSG/FieldDefinitions_Generated.json",
        Path.Combine(currentDir, "..", "..", "FieldDefinitions_Generated.json"),
        Path.Combine(currentDir, "FieldDefinitions_Generated.json")
    };
}
```

#### Override Processing
Field overrides in `mb2000.overrides.json` support multiple modes:

- **`packed`**: Packed decimal (COMP-3) conversion
- **`copyTrim`**: Direct copy with trimming
- **`zonedDecimal`**: Zoned decimal conversion
- **`ebcdic_spaces`**: Fill with EBCDIC spaces (0x40)

### Complete End-to-End Workflow

#### 1. Initial Setup
```bash
# Generate field definitions from DD file
python3 regenerate_field_definitions.py

# Bootstrap overrides from compiled schema
dotnet run --project src/Cnp.Cli -- bootstrap-overrides-from-compiled \
  --schema config/base/mblps \
  --out config/base/mblps/mb2000.overrides.json
```

#### 2. Schema Compilation
```bash
# Build compiled schema for pipeline
dotnet run --project src/Cnp.Cli -- build-schema \
  --schema config/base/mblps \
  --out schemas/compiled
```

#### 3. Pipeline Execution
```bash
# Process specific job
dotnet "/Users/vshanmu/3OSG/MBCNTR2503.Modernizer/src/Cnp.Cli/bin/Debug/net8.0/Cnp.Cli.dll" run-pipeline \
  --job 69172 \
  --schema "/Users/vshanmu/3OSG/MBCNTR2503.Modernizer/config/base/mblps" \
  --verbose
```

#### 4. Validation & Debugging
```bash
# Check parity
python3 debug-parity.py 69172

# Analyze patterns (if errors found)
python3 advanced_pattern_analyzer.py
python3 zero_variations_analyzer.py
```

## Troubleshooting

### Common Issues

#### Pipeline Fails with "FieldDefinitions_Generated.json not found"
```bash
# Regenerate field definitions
python3 regenerate_field_definitions.py
```

#### Parity Check Shows High Error Count
1. Check field offsets in `mb2000.overrides.json`
2. Verify packed decimal field definitions
3. Analyze error patterns with debugging scripts

#### Packed Decimal Conversion Issues
- Ensure `sourceOffset` and `sourceLength` match DD file
- Verify `decimalPlaces` in `FieldDefinitions_Generated.json`
- Check for EBCDIC vs ASCII source data

---

## Key Technical Insights

### Field Mapping Corrections
- **MB-PAYMENT-AMOUNT**: Fixed offset from 749 to 323, length from 1 to 6 bytes
  - Source: `MB1100-TOT-PYMT` from `mb1500.dd` (total payment calculation)
  - Format: `S9(9)V99 COMP-3` (6-byte packed decimal with 2 decimal places)
- **FieldDefinitions_Generated.json**: Corrected loading path resolution for runtime field metadata

### Data Conversion Issues Resolved
- **ASCII Detection**: Implemented smart detection for text fields already in ASCII format
- **Packed Decimal Handling**: Raw copy for P-records, proper encoding for MB2000 output
- **EBCDIC vs ASCII**: Fixed parity script to decode MB2000 output as ASCII, not EBCDIC

### Debugging Methodology
1. **Pattern Analysis**: Categorized errors by type (LENGTH_MISMATCH, ZERO_VARIATIONS, etc.)
2. **Legacy Code Analysis**: Traced data flow through COBOL programs (`setmb2000.cbl`, `mb1500.dd`)
3. **Systematic Offset Correction**: Used hexdump analysis to find correct field positions
4. **Incremental Testing**: Fixed one pattern at a time with immediate parity validation

---

# Useful Commands (Recommended)
  ```bash
  # Build JSON schema from DD and IO map
  dotnet run --project src/Cnp.Cli -- build-schema --schema config/base/mblps --out schemas/compiled
  
  # Bootstrap overrides from compiled schema (preferred)
  dotnet run --project src/Cnp.Cli -- bootstrap-overrides-from-compiled \
    --schema config/base/mblps \
    --out config/base/mblps/mb2000.overrides.json
  
  # Initial skeleton overrides (deprecated)
  #  dotnet run --project src/Cnp.Cli -- init-overrides --template schemas/source/mb2000.output.schema.json --schema config/base/mblps --out overrides.template.json
  ```



## End-to-End Pipeline Flow (Legacy vs C#)

The modernization reproduces the legacy monthly bill run in distinct stages. This section documents the end-to-end flow and shows which modern C# component corresponds to each legacy script/program and what artifact it produces. Use this as the authoritative reference for coverage and gaps.

### 1) Container Step 1 (normalize container and derive diagnostics)
- **Legacy**: `ncpcntr5v2.script` and related tools
- **Inputs**: `<job>.dat`
- **Outputs**: `<job>.4300`, `<job>.dat.rectype`, `<job>.dat.total`, `<job>.4300.txt`, `<job>.4300.txt.suspect`, `<job>.4300.txt.new`, `<job>.4300.txt.length`, `<job>.ncpjax`
- **Modern C#**:
  - `Cnp.Pipeline.Step1Orchestrator` ‚Üí `.4300`, `.dat.rectype`, `.dat.total`
  - `Cnp.Pipeline.TextExtractor` ‚Üí `.4300.txt`
  - `Cnp.Pipeline.SuspectValidator` ‚Üí `.4300.txt.suspect`
  - `Cnp.Pipeline.TxtNewMerger` ‚Üí `.4300.txt.new`, `.4300.txt.length`
  - `Cnp.Pipeline.NcpjaxGenerator` ‚Üí `.ncpjax`
- **Status**: 100% perfect parity across all four jobs (see Job Status Details above)

### 2) EBCDIC ‚Üí ASCII conversion and record split
- **Legacy**: `setmb2000.script` ‚Üí `mbcnvt0.out` then `ncpsplitall.out`
- **Inputs**: `<job>.dat`
- **Outputs**: `<job>.dat.asc`, `<job>.dat.asc.11.1.p`, `<job>.dat.asc.11.1.s`, `<job>.dat.asc.11.1.d`
- **Modern C#**: `Cnp.Pipeline.EbcdicProcessor.ProcessDatToAsc`
- **Configuration**: DD/IOMAP under `config/base/mblps` (no hardcoding); schema compiled via `Cnp.Schema`
- **Status (parity)**: `.dat.asc ~64‚Äì65%`, `.asc.11.1.d ~99.9%`, `.asc.11.1.p ~99.9%`, `.asc.11.1.s ~53%` (varies per job; see report)

### 3) Key enrichment (add keys to P/S records)
- **Legacy**: `cnpfilekeys.out`
- **Inputs**: `<job>.dat.asc.11.1.p`, `<job>.dat.asc.11.1.s`
- **Outputs**: `<job>.dat.asc.11.1.p.keyed`
- **Modern C#**: `Cnp.Pipeline.KeyEnrichmentProcessor`
- **Status (parity)**: ~99.65‚Äì99.72% match across jobs

### 4) MB2000 conversion (1500-byte P ‚Üí 2000-byte MB2000 record)
- **Legacy**: `setmb2000.out` (driven by `setmb2000.script`), with client-specific branches in `setmb2000.cbl`
- **Inputs**: `<job>p.asc`/`<job>.dat.asc.11.1.p.keyed`
- **Outputs**: `<job>p.set` (2000 bytes/record)
- **Modern C#**: `Cnp.Pipeline.MB2000FieldMapper` (client-aware) + overrides from `config/base/mblps/mb2000.overrides.json` and optional `mb2000.overrides.<client>.json`
- **Status (parity)**: ~71‚Äì73% content match; client-specific field logic still being ported

### 5) E-bill split and post-processing
- **Legacy**: `cnpsplit4.out` to separate E vs P accounts, with renames to `e.asc`, `p.asc`, `e.txt`
- **Modern C#**: Not yet implemented (planned). To be expressed as `IEbillSelector` strategy and file writers.

### 6) Grouping, tagging, counts, samples, remit artifacts
- **Legacy**: `ncpcntr0v2.script`, `tagit10.script`, remote GMC pass, `cnpautocount.out`, `ncpcntrsample0.out`
- **Outputs**: `*p.cntr.wrk`, `*p.cntr.grp`, `*e.cntr.grp`, `.total`, `.sample`, `.remit3`, `.count.auto`, aggregated `.all.grp`
- **Modern C#**: Not yet implemented (planned). Will be modeled as additional pipeline stages with deterministic writers.

### 7) Mail tracking containers
- **Legacy**: `cntrimbremit.script`, `cnpimbremit1.script`
- **Modern C#**: Out of current scope.


## Legacy ‚Üî C# Implementation Mapping

| Stage | Legacy component (script/program) | Primary outputs | Modern C# counterpart | Config/Overrides | Coverage/Status |
|------|------------------------------------|------------------|-----------------------|------------------|-----------------|
| Container Step 1 | `ncpcntr5v2.script` (+ helpers) | `.4300`, `.dat.rectype`, `.dat.total` | `Step1Orchestrator` | `config/base/mblps` DD/IOMAP | 100% perfect parity |
| Text extraction | Part of Step 1 flow | `.4300.txt` | `TextExtractor` | Compiled schema fields | 100% perfect parity |
| Suspect validation | Part of Step 1 flow | `.4300.txt.suspect` | `SuspectValidator` | ASCII/EBCDIC rules from schema | 100% perfect parity |
| Text merge/length | Part of Step 1 flow | `.4300.txt.new`, `.4300.txt.length` | `TxtNewMerger` | Schema-driven | 100% perfect parity |
| Key derivation | `ddcontrol` parsing path | `.ncpjax` | `NcpjaxGenerator` | `config/base/mblps/ddcontrol*` | 100% perfect parity |
| EBCDIC‚ÜíASCII | `mbcnvt0.out` | `.dat.asc` | `EbcdicProcessor` | Schema-driven field types | ~64‚Äì65% match |
| Record split | `ncpsplitall.out` | `.asc.11.1.p/s/d` | `EbcdicProcessor` (split) | Schema record types | d/p ~99.9%, s ~53% |
| Key enrichment | `cnpfilekeys.out` | `.asc.11.1.p.keyed` | `KeyEnrichmentProcessor` | Fixed record specs | ~99.65‚Äì99.72% |
| MB2000 convert | `setmb2000.out` + `setmb2000.cbl` | `<job>p.set` | `MB2000FieldMapper` | `mb2000.overrides*.json` | ~71‚Äì73% |
| E‚Äëbill split | `cnpsplit4.out` | `e.asc`, `e.txt`, `p.asc` | Planned `IEbillSelector` + writers | Externalized rules | Not implemented |
| Grouping/rollups | `ncpcntr0v2.script`, `tagit10.script`, GMC | `*cntr.grp*`, `.total`, `.sample`, `.remit3`, `.count.auto`, `.all.grp` | Planned pipeline stages | To be modeled | Not implemented |
| Mail tracking | `cntrimbremit.script`, `cnpimbremit1.script` | Mail tracking containers | Out of scope | N/A | Not in scope |

Notes:
- All field positions/types come from compiled schema produced from `config/base/mblps` inputs. Client-specific behavior must be captured via override files ‚Äî no hardcoding.
- Client-aware overrides: the orchestrator prefers `mb2000.overrides.<client>.json` over the base `mb2000.overrides.json` when present.


## Coverage, Gaps, and Next Actions

- **Covered (parity achieved):**
  - Container Step 1: `.4300`, `.dat.rectype`, `.dat.total`, `.4300.txt`, `.4300.txt.suspect`, `.4300.txt.new`, `.4300.txt.length`, `.ncpjax`

- **Partially covered (needs work):**
  - EBCDIC‚ÜíASCII and split: Improve `.dat.asc` and `.asc.11.1.s` fidelity (see per-job stats). Validate text vs numeric conversions near mixed zones and packed windows.
  - Key enrichment: Minor residual diffs; re-check formatting and key composition edge cases.
  - MB2000 conversion: Port client-specific logic from `setmb2000.cbl` into configuration-driven transformers and finalize mappings in `mb2000.overrides*.json`.

- **Not yet covered (planned):**
  - E‚Äëbill split (`cnpsplit4.out` equivalence) and renames (`e.asc`, `e.txt`, `p.asc`).
  - Grouping/rollups (`*cntr.grp*`, `.total`, `.sample`, `.remit3`, `.count.auto`, `.all.grp`).
  - Mail tracking container generation.

- **Immediate next actions (no hardcoding; use overrides):**
  - Externalize and validate S‚Äërecord conversion nuances in `EbcdicProcessor` using schema metadata; add targeted tests for the 53% S‚Äërecord gap.
  - Complete client-aware mapping rules for MB2000 in `mb2000.overrides.json` and `mb2000.overrides.<client>.json`; implement customer transformers aligned to `setmb2000.cbl` branches (e.g., `BUILD-0503-FIELDS`).
  - Tighten key enrichment parity by verifying field offsets, zero‚Äëfill, and counter formatting.
  - Design and implement `IEbillSelector` strategy + writers to reproduce `cnpsplit4.out` behavior using configuration.
  - Model grouping/tagging/count/sample/remit as deterministic stages with schema-driven parameters.

Cross‚Äëreferences for developers:
- Detailed design: `MBCNTR2503.CSharpDesign.md`
- Field metadata: `FieldDefinitions_Generated.json`
- Overrides: `config/base/mblps/mb2000.overrides.json` (+ client-specific variants)
- CLI entry: `src/Cnp.Cli` (`run-pipeline`, `build-schema`, and related commands)

### TODO (Permanent fixes replacing overrides)

- Replace `deltaAfterIBM037` offset rules with proper field-mode handling in `EbcdicProcessor`:
  - Ensure windows currently differing (e.g., per-record positions 9‚Äì11 and 1509‚Äì1511 in `.asc.11.1.s`, and small D/P windows) are decoded with Standard(IBM037) where appropriate instead of raw copies.
  - Keep zoned-decimal blank handling for S records in code (blank EBCDIC ‚Üí ASCII spaces) and remove equivalent overrides.
  - Align memmove/post-processing ordering to legacy so spacing/byte-kind matches without deltas.
- Implement real `IsLoanFieldPacked()` in `EbcdicProcessor` (reuse Step1 logic) and stop relying on placeholder behavior.
- After parity proves stable across all jobs, delete narrow `deltaAfterIBM037` rules from `config/base/mblps/ebcdic.overrides.json`.
